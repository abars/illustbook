<hr>
<h2 id="chap_0">０．まえがき</h2>
<h3>０．１　MOPERブラウザーで動画を見る</h3>
<p>　まずは、<a href="http://www.illustbook.net/mopersample/201194511.html">デモ</a>をご覧下さい。滑らかにキャラクターが動いていると思います。</p>
<center>
<script type="text/javascript" src="http://www.illustbook.net/moper_player?bbs_key=agtpbGx1c3QtYm9va3IMCxIDQmJzGPHS1wEM&thread_key=agtpbGx1c3QtYm9va3ISCxIJTWVzVGhyZWFkGKSu6AEM"></script><br>
画面１：ＭＯＰＥＲブラウザ画面説明</center>
<p>さて、表示画面上の〔フレーム間補間表示〕を切り替えて〔非補間表示〕にして下さい。キャラクターはパラパラ漫画のようにしか動きません。間の動きはＭＯＰＥＲエンジンが自動で作り出しているのです。逆に、パラパラ漫画の労力で滑らかなアニメーションをどなたにでも作成してもらう事がＭＯＰＥＲの最終目標です。</p>
<h3>０．２　MOPERで何ができるか</h3>
<p>　スレッドメニューの〔ＭＯＰＥＲで動画を描く〕で以下に解説をするＭＯＰＥＲエディタに入ることができます。ＭＯＰＥＲエディタは、自分のＰＣ上にデータをおいて、継続して作成作業ができる機能もそろっています。その使い方はいろいろな組み合わせがあります。</p>
１．作成データをイラストブックの掲示板に置いておく。必要なときは再編集して、掲示板に再投稿する。尚、一つのデータには容量制限があります。<br>
２．データを自分のＰＣ（ローカル）に保存しておき、アニメーションをＧＩＦアニメーション・ＪＰＥＧ連写で出力し、ニコ静さん、PIXIVさん、CLIPさんに投稿する。<br>
３．データを自分のＰＣ（ローカル）に保存しておき、アニメーションを連番png形式で出力し、AVIファイル等へ変換後、音をつけて再編集して、ニコ動さんやYoutubeさんに投稿する。<br><br>
<center><img src="static_files/moper/face.gif"><br><br>画面２：ＧＩＦ出力</center>
<center><img src="static_files/moper/face.jpg"><br><br>画面３：ＪＰＥＧ出力</center>
<br>　２枚の絵から数十枚の絵を作る魔法のような話しですが、コンピュータが自動でコマを割っているだけなので、製作者もコンピュータが仕事をしやすいように絵を描く必要があります。
早速、３分（フレーム総数５４００枚）のフルフレームレートアニメーションに挑戦しましょう！</p>

<h2 id="chap_1">１．始めに</h2>

<h3>１．１　基本操作説明</h3>

<p>　まずは、本文で使用する幾つかの用語を説明しましょう。</p>

<center><img src="static_files/moper/fig_0.png"><br><br>図１：ＭＯＰＥＲエディット画面説明</center>

<p>　ＭＯＰＥＲエディット画面は、絵を作成する<b>描画エリア</b>、絵を構成する曲線（<b>オブジェクト</b>）を編集する<b>属性設定エリア</b>、レイヤーの前後関係と時間軸上の動きを編集する<b>スコア</b>からなります。

<p><b>●スコアの説明</b>　スコア上のマス目に表示された小さな四角（<b>プレーン</b>）を選択して、描画エリア上にオブジェクトを描き、囲まれる領域を塗って動画を作成します。ここで、一つのプレーンは、重ね書きの層（<b>レイヤ</b>）とプレーン表示時刻（<b>タイムライン</b>）の２つで決められることに注意してください。
ＭＯＰＥＲは、同じレイヤー上の異なる時刻に描かれた複数のプレーン（<b>ＬＬセット</b>）上のオブジェクトの間を滑らかに自動で埋めて動かすツールと考えてください。また、同一時刻の複数のプレーン（<b>ＴＬセット</b>）は常に同時に表示されます。<br><br>

<center><img src="static_files/moper/fig_1.png"><br><br>図２：スコア説明</center>

<p><b>●オブジェクト用基本ツールの説明</b>　属性設定エリアと描画エリアの間にある縦一列のボタンについて説明します。<br><br>

<table bgcolor="#cccccc"><tr><td>
・〔アンドゥ｜リドゥ〕すべての編集操作をキャンセルするキーです。<br>
・〔ペン｜選択｜消去｜コピー｜ペースト〕プレーン上のオブジェクトを描いたり・消したり・コピペするためのプレーン編集用キーです。<br>
・〔ハンド｜ズームイン｜ズームアウト〕オブジェクト編集の場合に描画エリアでの表示の仕方を変更するキーです。尚、これによってオブジェクトは影響されません。<br>
・〔全移動｜全拡大｜全回転｜全反射〕ＴＬセット上の全てのオブジェクトを移動・拡大・回転・反射するためのＴＬセット編集用キーです。<br>
</td></tr></table><br>

　スコア下にある横一列のボタンについて説明します。<br><br>
<table bgcolor="#cccccc"><tr><td>
・〔作業領域クリア〕スコア左の空欄<b>作業領域</b>にＴＬセットを格納して処理できます。作業領域の中身を消去するキーです。<br>
・〔先頭｜再生｜通常・振子〕スコア上に再生領域指定なしの場合、〔先頭〕＋〔再生〕で頭から再生するキーです。通常は順方向、振子は順逆方向を反復します。<br>
・〔追加｜削除｜複製｜区切｜参照｜ラスター｜全複製〕：一つのプレーンを追加・削除・複製するキーです。全複製は、ＴＬセットの全てを複製するキーです。<br>
・〔時間軸縮小｜時間軸拡大〕スコアの時間方向を拡大・縮小して表示するキーです。<br>
</td></tr></table><br>
ここで説明のないキーに関しては、以降で説明を行います。では、早速、アニメーション

<center><img src="static_files/moper/out_1.gif"><br>【<b>弾むボール</b>】</center>

を作成してみましょう。<br><br>
１．まず、スコア上の左上のプレーンＡを〔選択〕し、〔ペン〕を押します。<br>
２．属性設定エリアが開きますので、〔形状｜直線〕を選び、描画エリア下方に地平線を描いて下さい。<br>
３．〔ペン〕のまま、プレーンＡの下のプレーンＢを押し、属性設定エリアから〔形状｜円〕を選んで、描画エリア上方にボールを描いて下さい。<br><br>
この状況でスコアの下にある〔再生〕を押しても何もおきません。時間軸方向に伸びるＬＬセットを構成していないからです。そこで、<br><br>
４．〔選択〕を選び、スコア上でプレーンＢを選び、〔複製〕を押します。するとプレーンＢの右にプレーンＢ２が現れます。<br>
５．プレーンＢ２を選択し、描画エリア上の円を地平線に接するまで下げて下さい。<br><br>
この状況で〔再生〕を押すとボールが上下するアニメーションができます。しかし、ボールが柔らかく弾んでいませんので、<br><br>
６．プレーンＢ２を選び、〔複製〕を押します。するとプレーンＢの右にプレーンＢ３が現れます。<br>
７．プレーンＢ３を選び、〔全拡大〕を押します。描画エリア左上に現れる文字をＹ拡大にして、円を楕円に潰し、地平線に接するように移動してください。<br><br>
この状況で〔再生〕を押すとボールが潰れて跳ね上がるシーンができます。よりリアルになるようにプレーンＢ２とＢ３を時間軸方向で離したり近づけたりして
再生時間を調整してみてください。<br><br>

<center><img src="static_files/moper/fig_2.png"><br><br>図３：基本操作説明</center>

<p><b>●オブジェクト属性の説明</b>　次に上記のアニメーションに彩色と影づけの効果を与えて
<center><img src="static_files/moper/out_2.gif"><br>【<b>弾むボール２</b>】</center><br>

を作成してみましょう。オブジェクトには次のような属性が定義されています。<br><br>

<table bgcolor="#cccccc"><tr><td>
１．輪郭形状：直線・曲線・矩形・円<br>
２．輪郭状態：ペン幅　０～６４画素<br>
２．領域状態：塗り有り・塗り無し<br>
３．透過状態：α値　２５６段階<br>
４．発色状態：ＲＧＢ　各２５６段階<br>
５．描画状態：描画順１プレーン　８段階<br>
６．対応関係：特徴点<br>
７．輪郭状態：順・逆方向<br>
</td></tr></table><br>

これらのオブジェクトの状態を定義する事で描画とアニメーションの質を変える事ができます。<br><br>

１．Ｂ１の円を選択してください。次に属性設定エリアで好みの色や線の太さを選んでください。<br>
２．終了したら〔パレットに登録〕を押してください。<br>
３．Ｂ２とＢ３の円を選択し、登録されたパレットを押してください。Ｂ１と同じように属性が決定されます。<br><br>


次に左上からスポットライトが当たっている雰囲気でボールの下方に影を描いて行きます。<br><br>

４．〔ペン〕を選択してＢ１の円の下に影を描いて下さい。次に〔選択〕して半透明の黒い影になるように属性を決め、パレット登録。<br>
５．ボールよりも影の描画順が右にある事を確認してください。描画順はプレーン内のサブレイヤーの番号となっています。<br>
６．Ｂ２とＢ３にも同様の手順で影を描きます。このとき、Ｂ１～Ｂ３まで対応するボールと影の描画順は一貫して同じ事を確認してください。<br><br>

最後に地面にボールの影を描いて行きます。<br><br>

６．Ｃ１に円を描き、楕円へ変形し、属性を設定します。<br>
７．Ｃ１を複製し、Ｃ２を作成します。ボールの落下点まで影を移動して下さい。<br>
８．Ｃ２を複製し、Ｃ３を作成します。<br><br>

ここで〔再生〕すると影がボールの上に来てしまいます。これは、ＣはＢの上位のレイヤーだからです。<br><br>

９．ＣのＬＬセットの先頭の●を押したまま、Ｂの●へ移動させてスワップする。<br><br>

これで目標のアニメーションの完成です。<br><br>

<center><img src="static_files/moper/fig_3.png"><br><br>図４：属性選択エリアとＬＬセット移動</center>

<h3>１．２　オブジェクトの作成と編集</h3>
<b>●オブジェクト作成</b>　ＭＯＰＥＲエンジンでオブジェクトを動かすには、<br><br>

<center><b>同じLLセット上のプレーンにおいて同じ描画順のオブジェクトが存在する</b></center><br><br>
必要があります。言い換えれば、ある曲線の未来の形や過去の形も描かれていなければアニメーションにはならないということです。<br><br>
　仮に彩色したい場合は、オブジェクトを境界として線で囲む必要があります。例えば、髪の毛の場合、先から頭の境界までまとめて描く必要があります。
さらに線は滑らかで髪の先は鋭利に（これを尖点といいます）描くことは非常に難しいことですよね。下の図は描いた線を自動で滑らかにする〔補正〕機能を
使ってどのようにオブジェクトが変化するか示しています。やはり、線を滑らかにするほど尖点が丸くなってしまうわけです。

<br><br><center><img src="static_files/moper/fig_4.png"><br><br>図５：前髪のオブジェクト</center><br><br>

そこで〔結合ペン〕の利用をお勧めします。まず、〔結合ペン〕を選択し、属性設定エリアで〔補正〕を２か３にし、
滑らかな線で髪の輪郭を描いていきます。この時、尖点となるところは次の線とほんの少し交差させて"Ｘ"となるようにしてください。描く度に"Ｘ"の交点周辺の枝２本が切り取られ"Ｖ"になって結合されて行きます。
仮に書き損じた場合は、〔分離〕を選択し、不要な部分と残したい部分を切り離してください。次に、〔結合ペン〕の描画画面上の左上のモードで選択を選び、
残したいオブジェクトを指定して、選択を終了すると線の続きから描くことができます。

<br><br><center><img src="static_files/moper/fig_5.png"><br><br>図６：前髪のオブジェクト</center><br><br>

<b>●オブジェクト編集</b>　それでは先ほど描いた髪毛の次フレームを作成してみましょう。同一レイヤーに次のプレーンを〔追加〕し、
〔ペン〕を選択すると前のオブジェクトのゴーストが出るライトテーブルが始まります。後は、次のオブジェクトの動きをつけて線を引いて行きます。
このとき、新しいオブジェクトの交点は前のオブジェクトの交点と自明な対応関係がつくように線を引いて下さい。
<br><br><center><img src="static_files/moper/fig_6.png"><br><br>図７：前髪のオブジェクト次フレーム</center><br><br>
できあがったら〔結合〕して〔再生〕を押してみてください。もしも、交点の対応関係がおかしく動きが変なときは、下の図のようにオブジェクトを
選択して特徴点編集を選んでください。
<br><br><center><img src="static_files/moper/fig_7.png"><br><br>図８：特徴点の編集</center><br><br>
青で表示される点と緑で表示される円、２つのオブジェクト間でかならず対応する場所になっています。もし、この点の対応関係が
おかしいときは描画エリア左上の〔特徴点クリア〕を押して、正しい対応関係の位置に緑の円を置いていってください。〔結合〕キーの下の〔分離〕を押すことで
結合されたオブジェクトを再分割することもできます。<br><br>

<hr>
<h2 id="chap_2">２．基礎編</h2>
<h3>２．１　顔の表情を動かす</h3>
では、多くのオブジェクトを組み合わせたアニメーション
<center><img src="static_files/moper/out_3.gif"><br>【<b>あいう</b>】</center><br>
を製作しながら、さらにオブジェクトの描画と編集について説明しましょう。<br><br>

<b>●レイヤーの構成を決めながら基本フレームを作成する</b>
一つ目のＴＬセットのレイヤー構成は以下の図のようになっています。
<br><br><center><img src="static_files/moper/fig_8.png"><br><br>図９：顔の基本フレーム</center><br><br>
プレーンＡ：後ろ髪（領域）＜首（領域）<br>
プレーンＢ：顔（領域）＜鼻（領域）＜口の下線（曲線）＜口内（領域）＜歯（領域）＜唇（曲線）<br>
プレーンＣ・Ｄ：白目（領域）＜瞳１（領域）＜瞳２（領域）＜キラ（領域）＜まつげ下（曲線）＜まつげ上（領域）＜まぶた影（領域）＜眉毛（領域）<br>
プレーンＥ：右髪（領域）＜左髪（領域）＜前髪影（領域）＜前髪（領域）＜ハイライト（領域）<br><br>
上記の各プレーンにおいて”＜”は、描画順の番号の大きさを示しています。つまり、若い番号ほど後方に描かれ隠蔽されるオブジェクトになります。
この性質を利用してプレーンＢでは、後のＴＬセットで見える「口の中のオブジェクト」を唇のオブジェクトで隠蔽して描いてあります。<br><br>
<center><img src="static_files/moper/fig_9.png"><br><br>図１０：口を開くための３つのオブジェクト</center><br><br>

<b>●基本フレームのＴＬセットを複写・参照する</b>　

次は、基本フレームのＴＬセットを複写して、２番目のＴＬセット作ってみましょう。まず、基本フレームのプレーンを選択し、〔全複写〕を押してください。
すると作業用窓にＴＬセットごと複写されます。作業窓の上にあるバーを押して、適当なスコア上の場所に移動してください。次に第２ＴＬセットで、
口の形を描き換えます。さて、第３のＴＬセットでは、再び口を閉じますので基本フレームを複写します。ただし、後の編集作業で基本フレームを書き換えると、
複写したすべてのフレームも書き換え作業が必要となって大変です。そこで、一度、基本フレームのすべてのプレーンを〔参照〕して第３ＴＬセットを作成しておきます。
以降、〔参照〕して作ったプレーンの情報は〔全複写〕で複製した場合も保持されます。逆に、〔参照〕の属性を解除したい場合は、〔作業領域消去〕の隣の
〔作業領域属性クリア〕を押して下さい。これを繰り返して３つのＴＬセットを用意して、間のプレーンの口の形を書き換えて下さい。〔再生〕すると口のアニメーションができます。
<br><br><center><img src="static_files/moper/fig_10.png"><br><br>図１１：ＴＬセットの複写方法</center><br><br>


<h3>２．２　エフェクトを利用する</h3>
<b>●属性値フェイド</b><br><br>

<b>●オブジェクトループ</b><br><br>

<b>●強制変形</b><br><br>


<hr>
<h2 id="chap_3">３．応用編</h2>


<hr>
<h2 id="chap_4">４．動画ファイルでＰＶ作成</h2>
　音と同期するアニメーションが完成しましたら早速、ＰＶを完成させましょう！<br><br>

<b>●連番PNG分割ツールの準備</b><br>
１．<a href="http://www.illustbook.net/static_files/moper_div.zip">http://www.illustbook.net/static_files/moper_div.zip</a>からzipファイルをダウンロード<br>
２．zipファイルを任意の場所に解凍<br><br>

<b>●連番PNGの書出し</b><br>
１．画面右上の“書出”ボタンをクリック<br>
２．書き出し設定が表示されるので任意に設定（フレームレートは30付近がオススメ）<br>
３．“連番PNG書出”ボタンをクリック<br>
４．エンコードが終了するまで待機<br>
５．エンコードが終了したら現れる“ファイルに保存”ボタンをクリック<br>
６．連番PNGツールと同じディレクトリにbinファイルを保存<br>
　（例えば連番PNGツールのディレクトリをc:\moper_div，binファイルをout.binとします）<br>
７．コマンドプロンプトを開きます<br>
　（Windowsキー+Rでファイル名を指定して実行ダイアログを開き、名前にcmdとタイプし、OKをクリックします）<br>
８．連番PNG分割ツールのディレクトリへ移動<br>
　（例：cd c:\moper_divとタイプしてEnterする）<br>
９．win_div.exe 入力ファイル名 出力ディレクトリ名
として実行<br>
　（例：win_div.exe　out.bin ./）<br>
１０．PNGファイルが出力されたことを確認<br><br>

<b>●動画エンコード（AviUtl）を使った場合</b><br>
１．<a href="http://spring-fragrance.mints.ne.jp/aviutl/">http://spring-fragrance.mints.ne.jp/aviutl/</a>からファイルをダウンロードして解凍<br>
２．AviUtlを起動し、ファイル－開くを実行<br>
３．00000000.pngを選択し、ダイアログ下方の“fps変換無し”をMOPER書出しの時に設定したフレームレートに設定（たとえば30fps）<br>
４．開くボタンをクリックすれば連番PNGの読み込みが行われる<br>
５．ファイル－AVI出力を実行し、任意の名前をつけて保存すれば動画ファイルが生成が完了<br><br>

※AviUtlの使い方詳細は他サイトをご覧ください。<br>
ニコニコ動画用の設定であれば<br>
・AviUtlを使ったMP4 (H.264) エンコード：<a href="http://nicowiki.com/aviutl_h264.html">http://nicowiki.com/aviutl_h264.html</a><br>
・AviUtlを使ったVP6 2pass：<a href="http://nicowiki.com/ffmpeg_aviutl.html">http://nicowiki.com/ffmpeg_aviutl.html</a><br>
が参考になります。<br>